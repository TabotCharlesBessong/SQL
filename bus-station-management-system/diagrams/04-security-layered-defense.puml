@startuml Bus Station Management System - Security Layered Defense Model
!theme plain
skinparam backgroundColor #FAFBFC
skinparam roundcorner 6
skinparam rectangleBorderColor #37474F

title Figure 4: Security Design â€“ Layered Defense Model\n**Bus Station Management System**

' Four layers: gradient from outer (lighter) to inner (slightly darker) - blue-grey scale
rectangle "**Layer 1: Physical Security**" as L1 #ECEFF1 {
  rectangle "Access control\n(server room, offices)" as P1 #CFD8DC
  rectangle "CCTV / monitoring" as P2 #CFD8DC
  rectangle "Locked enclosures\n(racks, workstations)" as P3 #B0BEC5
}

rectangle "**Layer 2: Network Security**" as L2 #E8EAF6 {
  rectangle "Firewall\n(Inbound/Outbound)" as N1 #C5CAE9
  rectangle "TLS 1.2/1.3\n(HTTPS)" as N2 #C5CAE9
  rectangle "VPN\n(remote staff)" as N3 #9FA8DA
  rectangle "Network segmentation\n(VLANs)" as N4 #9FA8DA
}

rectangle "**Layer 3: Application Security**" as L3 #E0F2F1 {
  rectangle "Authentication\n(Password, MFA)" as A1 #B2DFDB
  rectangle "Authorization\n(RBAC)" as A2 #B2DFDB
  rectangle "Input validation\n(SQLi, XSS, CSRF)" as A3 #80CBC4
  rectangle "Session management\n(JWT, expiry)" as A4 #80CBC4
}

rectangle "**Layer 4: Data Security**" as L4 #EFEBE9 {
  rectangle "Encryption at rest\n(AES-256 / TDE)" as D1 #D7CCC8
  rectangle "Encryption in transit\n(TLS)" as D2 #D7CCC8
  rectangle "PII / sensitive data\nprotection" as D3 #BCAAA4
  rectangle "Audit logging\n(immutable)" as D4 #BCAAA4
}

L1 -[#546E7A]-> L2 : Enforced at\nperimeter
L2 -[#546E7A]-> L3 : Enforced on\nAPI/App
L3 -[#546E7A]-> L4 : Enforced in\nDB & storage

note right of L1
  **Physical**
  Prevent unauthorized
  physical access to
  servers and workstations
end note

note right of L2
  **Network**
  Protect data in transit,
  restrict access by
  firewall and VPN
end note

note right of L3
  **Application**
  Identity, roles, and
  secure coding to
  prevent exploitation
end note

note right of L4
  **Data**
  Protect data at rest,
  integrity, and
  compliance (audit)
end note

legend right
  |= Color |= Layer |
  | <#CFD8DC> | Physical |
  | <#C5CAE9> | Network |
  | <#B2DFDB> | Application |
  | <#D7CCC8> | Data |
endlegend

@enduml
