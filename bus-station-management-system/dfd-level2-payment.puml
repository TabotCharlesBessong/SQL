@startuml Level 2 DFD - Payment Processing (Process 3.0)

skinparam maxwidth 1600
skinparam maxheight 1100
skinparam dpi 300
scale max 1600x1100

title Level 2 Data Flow Diagram - Payment Processing (Process 3.0)

rectangle "Passenger" as Passenger
rectangle "Payment Gateway" as PaymentGateway

rectangle "D3\nBooking" as D3
rectangle "D4\nPayment" as D4

rectangle "2.0\nBooking" as P2

rectangle "3.1\nTransaction" as P31
rectangle "3.2\nRefund" as P32
rectangle "3.3\nVerification" as P33

P2 --> P31 : Payment request
Passenger --> P31 : Payment method
P31 --> PaymentGateway : Request
PaymentGateway --> P31 : Confirmation
P31 --> P2 : Status
P31 --> Passenger : Receipt
P31 --> D4 : write
P31 --> D3 : read/write
P31 --> P33 : Confirmation

P2 --> P32 : Refund request
P32 --> PaymentGateway : Refund request
PaymentGateway --> P32 : Confirmation
P32 --> P2 : Status
P32 --> Passenger : Confirmation
P32 --> D4 : read/write
D4 --> P32 : Payment info

PaymentGateway --> P33 : Confirmation
P33 --> P2 : Verification
P33 --> D4 : read/write

@enduml
